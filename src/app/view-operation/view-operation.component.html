<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button
        [text]="getBackButtonText()"
        defaultHref="/"
      ></ion-back-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <ion-item>
    <ion-icon
      aria-hidden="true"
      name="airplane-outline"
      color="primary"
    ></ion-icon>
    <ion-label class="ion-text-wrap label-operation-title" *ngIf="message">
      <h2>
        ID Operation:
        <span class="date">
          <ion-note> {{ message.operation_id }} </ion-note>
        </span>
      </h2>
      <h3>
        Route:
        <ion-note
          >{{ message.airport[0].selectDeparture }} -
          {{ message.airport[0].selectArrival }}
        </ion-note>
      </h3>
      <h3>
        Aircraft Type: <ion-note>{{ message.aircraft[0].oaci }}</ion-note>
      </h3>
      <h3>
        ETD UTC:
        <ion-note
          >{{ message.airport[0].etd_utc | date : "dd/MM/yyyy, HH:mm" }}
        </ion-note>
      </h3>
      <h3>
        ETA UTC:
        <ion-note>{{
          message.airport[0].eta_utc | date : "dd/MM/yyyy, HH:mm"
        }}</ion-note>
      </h3>
    </ion-label>
  </ion-item>

  <ion-card>
    <ion-card-header>
      <ion-item>
        <ion-icon
          aria-hidden="true"
          name="layers-outline"
          color="primary"
          size="small"
        ></ion-icon>
        <ion-card-title class="generic-title">Services</ion-card-title>
      </ion-item>
      <ion-card-subtitle>SAE Handling</ion-card-subtitle>
    </ion-card-header>
    <ion-card-content>
      <ion-list>
        <ion-item *ngFor="let service of message?.services">
          <ion-label>{{ service.title }}</ion-label>
          <ion-note> {{ service.quantity }} </ion-note>
        </ion-item>
      </ion-list>
    </ion-card-content>
  </ion-card>

  <ion-card>
    <ion-card-header>
      <ion-item>
        <ion-icon
          aria-hidden="true"
          name="people-outline"
          color="primary"
          size="small"
        ></ion-icon>
        <ion-card-title class="generic-title">Pax</ion-card-title>
      </ion-item>
      <ion-card-subtitle>Documents</ion-card-subtitle>
    </ion-card-header>
    <ion-card-content>
      <ion-list *ngIf="message">
        <ion-item
          *ngFor="let pax of message?.passengers"
          [routerLink]="['/datail-pax', pax.pax_id]"
        >
          <ion-label
            >{{ pax.pax_parental }}
            {{ pax?.pax_maternal ? " " + pax?.pax_maternal : "" }}
            {{ pax.pax_name }}</ion-label
          >
        </ion-item>
        <ion-item
          *ngIf="!message?.passengers || message.passengers.length === 0"
        >
          <ion-label>Aun no se han registrado pasajeros</ion-label>
        </ion-item>
      </ion-list>
    </ion-card-content>
  </ion-card>

  <ion-card>
    <ion-card-header>
      <ion-item>
        <ion-icon
          aria-hidden="true"
          name="people-outline"
          color="primary"
          size="small"
        ></ion-icon>
        <ion-card-title class="generic-title">Crew</ion-card-title>
      </ion-item>
      <ion-card-subtitle>Documents</ion-card-subtitle>
    </ion-card-header>
    <ion-card-content>
      <ion-list *ngIf="message">
        <ion-item
          *ngFor="let crew of message?.crews"
          [routerLink]="['/datail-crew', crew.crew_id]"
        >
          <ion-label
            >{{ crew?.crew_parental }}
            {{ crew?.crew_maternal ? " " + crew?.crew_maternal : "" }}
            {{ crew.crew_name }}</ion-label
          >
        </ion-item>

        <ion-item *ngIf="!message?.crews || message.crews.length === 0">
          <ion-label>Aun no se han registrado la tripulaci√≥n</ion-label>
        </ion-item>
      </ion-list>
    </ion-card-content>
  </ion-card>

  <ion-card>
    <ion-card-header>
      <ion-item>
        <ion-icon
          aria-hidden="true"
          name="folder-open-outline"
          color="primary"
          size="small"
        ></ion-icon>
        <ion-card-title class="generic-title">Operation</ion-card-title>
      </ion-item>
      <ion-card-subtitle>Documents</ion-card-subtitle>
    </ion-card-header>
    <ion-card-content>
      <!-- <ion-list>
         <ion-item>
          <div slot="start" [class]="!message[0].read ? 'dot dot-unread' : 'dot'"></div>
          <ion-label>Manifest</ion-label> 
        </ion-item>
  
        <ion-item>
          <div slot="start" [class]="!message[0].read ? 'dot dot-unread' : 'dot'"></div>
          <ion-label>Airworthiness Card</ion-label>
        </ion-item>
  
        <ion-item>
          <div slot="start" [class]="!message[0].read ? 'dot dot-unread' : 'dot'"></div>
          <ion-label>Mexican Insurance	</ion-label>
        </ion-item>
  
        <ion-item lines="none">
          <div slot="start" [class]="!message[0].read ? 'dot dot-unread' : 'dot'"></div>
          <ion-label>Certificate Tail	</ion-label>
        </ion-item> 
      </ion-list>-->
      <ion-list>
        <ion-item>
          <ng-container *ngIf="message?.fuel_release; else noImage">
            <ion-thumbnail slot="start">
              <a [href]="appUrl  + message?.fuel_release" download>
                <ion-img
                  *ngIf="!message?.fuel_release?.endsWith('.pdf')"
                  [src]="appUrl  + message?.fuel_release"
                  alt="SAE"
                ></ion-img>
                <ion-icon
                  *ngIf="message?.fuel_release?.endsWith('.pdf')"
                  name="cloud-download-outline"
                  class="large-icon"
                ></ion-icon>
              </a>
            </ion-thumbnail>
          </ng-container>

          <ng-template #noImage>
            <ion-thumbnail slot="start">
              <ion-img
                src="https://www.apricotmaps.com/resources/Pictures/docs/no-image.png"
                alt="Imagen predeterminada"
              ></ion-img>
            </ion-thumbnail>
          </ng-template>
          <ion-grid>
            <ion-row>
              <ion-col size="7">
                <ion-label> Fuel Release </ion-label>
              </ion-col>
              <ion-col size="5">
                <ion-button id="open-modal" expand="block">Verify</ion-button>
              </ion-col>
              <ion-content class="ion-padding">
                <ion-modal
                  trigger="open-modal"
                  [initialBreakpoint]="1"
                  [breakpoints]="[0, 1]"
                >
                  <ng-template>
                    <ion-list>
                      <ion-item>
        
                        <ion-toggle
                          aria-label="Success toggle"
                          color="success"
                          [checked]="true"
                          [checked]="message?.fuel_release_status === 1"
                          (ionChange)="checkboxChanged($event)"
                          >Verify Fuel Release<br /><ion-note class="ion-text-wrap"
                            >Make sure to check the document before checking
                            in</ion-note
                          ></ion-toggle
                        >
                      </ion-item>
                      <ion-item>
                        <ion-label position="floating">Comments</ion-label>
                        <ion-textarea
                          [(ngModel)]="message!.fuel_release_comments"
                        ></ion-textarea>
                      </ion-item>
                      <ion-row>
                        <ion-col size="12">
                          <ion-item>
                            <ion-button
                              class="large-btn"
                              (click)="enviarDatos('fuel_release')"
                              expand="full"
                              >Verify</ion-button
                            >
                          </ion-item>
                        </ion-col>
                      </ion-row>
                    </ion-list>
                  </ng-template>
                </ion-modal>
              </ion-content>
            </ion-row>
            <ion-grid>
              <ion-row>
                <ion-col size="12">
                  <ion-accordion-group>
                    <ion-accordion value="first" size="large">
                      <ion-item slot="header" color="light" size="large">
                        <ion-label>{{
                          getStatusLabel(message?.fuel_release_status)
                        }}</ion-label>
                      </ion-item>
                      <div class="ion-padding" slot="content">
                        {{ message?.fuel_release_comments }}
                      </div>
                    </ion-accordion>
                  </ion-accordion-group>
                </ion-col>
              </ion-row>
            </ion-grid>
          </ion-grid>
        </ion-item>
        <!-- PIU -->
        <ion-item *ngIf="message?.piu">
          <ng-container *ngIf="message?.piu; else noImage">
            <ion-thumbnail slot="start">
              <a [href]="appUrl  + message?.piu" download>
                <ion-img
                  *ngIf="!message?.piu?.endsWith('.pdf')"
                  [src]="appUrl + message?.piu"
                  alt="SAE"
                ></ion-img>
                <ion-icon
                  *ngIf="message?.piu?.endsWith('.pdf')"
                  name="cloud-download-outline"
                  class="large-icon"
                ></ion-icon>
              </a>
            </ion-thumbnail>
          </ng-container>

          <ng-template #noImage>
            <ion-thumbnail slot="start">
              <ion-img
                src="https://www.apricotmaps.com/resources/Pictures/docs/no-image.png"
                alt="Imagen predeterminada"
              ></ion-img>
            </ion-thumbnail>
          </ng-template>
          <ion-grid>
            <ion-row>
              <ion-col size="7">
                <ion-label> PIU </ion-label>
              </ion-col>
              <ion-col size="5">
                <ion-button id="open-modal-piu" expand="block">Verify</ion-button>
              </ion-col>
              <ion-content class="ion-padding">
                <ion-modal
                  trigger="open-modal-piu"
                  [initialBreakpoint]="1"
                  [breakpoints]="[0, 1]"
                >
                  <ng-template>
                    <ion-list>
                      <ion-item>
                        <ion-toggle
                          aria-label="Success toggle"
                          color="success"
                          [checked]="true"
                          [checked]="message?.piu_status === 1"
                          (ionChange)="checkboxChanged($event)"
                          >Verify PIU<br /><ion-note class="ion-text-wrap"
                            >Make sure to check the document before checking
                            in</ion-note
                          ></ion-toggle
                        >
                      </ion-item>
                      <ion-item>
                        <ion-label position="floating">Comments</ion-label>
                        <ion-textarea
                          [(ngModel)]="message!.piu_comments"
                        ></ion-textarea>
                      </ion-item>
                      <ion-row>
                        <ion-col size="12">
                          <ion-item>
                            <ion-button
                              class="large-btn"
                              (click)="enviarDatos('piu')"
                              expand="full"
                              >Verify</ion-button
                            >
                          </ion-item>
                        </ion-col>
                      </ion-row>
                    </ion-list>
                  </ng-template>
                </ion-modal>
              </ion-content>
            </ion-row>
            <ion-grid>
              <ion-row>
                <ion-col size="12">
                  <ion-accordion-group>
                    <ion-accordion value="first" size="large">
                      <ion-item slot="header" color="light" size="large">
                        <ion-label>{{
                          getStatusLabel(message?.piu_status)
                        }}</ion-label>
                      </ion-item>
                      <div class="ion-padding" slot="content">
                        {{ message?.piu_comments }}
                      </div>
                    </ion-accordion>
                  </ion-accordion-group>
                </ion-col>
              </ion-row>
            </ion-grid>
          </ion-grid>
        </ion-item>
        <!-- FLIGHT REQUEST CHARTER -->
        <ion-item *ngIf="message?.piu">
          <ng-container *ngIf="message?.piu; else noImage">
            <ion-thumbnail slot="start">
              <a [href]="appUrl  + message?.piu" download>
                <ion-img
                  *ngIf="!message?.piu?.endsWith('.pdf')"
                  [src]="appUrl + message?.piu"
                  alt="SAE"
                ></ion-img>
                <ion-icon
                  *ngIf="message?.piu?.endsWith('.pdf')"
                  name="cloud-download-outline"
                  class="large-icon"
                ></ion-icon>
              </a>
            </ion-thumbnail>
          </ng-container>

          <ng-template #noImage>
            <ion-thumbnail slot="start">
              <ion-img
                src="https://www.apricotmaps.com/resources/Pictures/docs/no-image.png"
                alt="Imagen predeterminada"
              ></ion-img>
            </ion-thumbnail>
          </ng-template>
          <ion-grid>
            <ion-row>
              <ion-col size="7">
                <ion-label> PIU </ion-label>
              </ion-col>
              <ion-col size="5">
                <ion-button id="open-modal-piu" expand="block">Verify</ion-button>
              </ion-col>
              <ion-content class="ion-padding">
                <ion-modal
                  trigger="open-modal-piu"
                  [initialBreakpoint]="1"
                  [breakpoints]="[0, 1]"
                >
                  <ng-template>
                    <ion-list>
                      <ion-item>
                        <ion-toggle
                          aria-label="Success toggle"
                          color="success"
                          [checked]="true"
                          [checked]="message?.piu_status === 1"
                          (ionChange)="checkboxChanged($event)"
                          >Verify PIU<br /><ion-note class="ion-text-wrap"
                            >Make sure to check the document before checking
                            in</ion-note
                          ></ion-toggle
                        >
                      </ion-item>
                      <ion-item>
                        <ion-label position="floating">Comments</ion-label>
                        <ion-textarea
                          [(ngModel)]="message!.piu_comments"
                        ></ion-textarea>
                      </ion-item>
                      <ion-row>
                        <ion-col size="12">
                          <ion-item>
                            <ion-button
                              class="large-btn"
                              (click)="enviarDatos('piu')"
                              expand="full"
                              >Verify</ion-button
                            >
                          </ion-item>
                        </ion-col>
                      </ion-row>
                    </ion-list>
                  </ng-template>
                </ion-modal>
              </ion-content>
            </ion-row>
            <ion-grid>
              <ion-row>
                <ion-col size="12">
                  <ion-accordion-group>
                    <ion-accordion value="first" size="large">
                      <ion-item slot="header" color="light" size="large">
                        <ion-label>{{
                          getStatusLabel(message?.piu_status)
                        }}</ion-label>
                      </ion-item>
                      <div class="ion-padding" slot="content">
                        {{ message?.piu_comments }}
                      </div>
                    </ion-accordion>
                  </ion-accordion-group>
                </ion-col>
              </ion-row>
            </ion-grid>
          </ion-grid>
        </ion-item>
      </ion-list>
    </ion-card-content>
  </ion-card>

  <ion-card>
    <ion-card-header>
      <ion-card-title class="generic-title">Invoice</ion-card-title>
      <ion-card-subtitle>Upload</ion-card-subtitle>
    </ion-card-header>
    <ion-card-content>
      <ion-button expand="block">Add New Invoice Upload</ion-button>
    </ion-card-content>
  </ion-card>
</ion-content>
